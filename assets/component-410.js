"use strict";(globalThis.webpackChunkshopify_craft_and_berry=globalThis.webpackChunkshopify_craft_and_berry||[]).push([[410],{344:(t,e,r)=>{r.d(e,{a:()=>n,f:()=>i});var a=r(129);async function i(t,e,r,i){try{const n=["id","handle","title"],s=(Array.isArray(i)?i.concat(n):i.split(",").concat(n).map(t=>t.trim())).map(t=>"images"===t?"images(first: 10) { nodes { url altText } }":t),o="id\nprice { amount currencyCode }",c=s.join("\n");let d,l;e&&"all"!==e?(d=function(t,e){return`\n    query ($handle: String!, $limit: Int!, $sortKey: ProductCollectionSortKeys!) {\n      collection(handle: $handle) {\n        products(first: $limit, sortKey: $sortKey) {\n          edges {\n            node {\n              ${t}\n              variants(first: 1) {\n                edges {\n                  node {\n                    ${e}\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }`}(c,o),l={handle:e,limit:t,sortKey:r}):(d=function(t,e){return`\n    query ($limit: Int!, $sortKey: ProductSortKeys!) {\n      products(first: $limit, sortKey: $sortKey) {\n        edges {\n          node {\n            ${t}\n            variants(first: 1) {\n              edges {\n                node {\n                  ${e}\n                }\n              }\n            }\n          }\n        }\n      }\n    }`}(c,o),l={limit:t,sortKey:r});const u=await async function(t,e={}){try{const r=`https://${a.d.shopDomain}/api/2025-07/graphql.json`,i=a.d.storefrontToken,n=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json","X-Shopify-Storefront-Access-Token":i},body:JSON.stringify({query:t,variables:e})}),s=await n.json();if(s.errors)throw new Error(s.errors.map(t=>t.message).join(", "));return s.data}catch(t){throw console.error("Shopify Fetch Error:",t),t}}(d,l);return(u.products?.edges||u.collection?.products?.edges||[]).map(t=>function(t){const e=t.variants?.edges?.[0]?.node||{};let r=null,a=null;t.images?.nodes&&t.images.nodes.length>0&&(r=t.images.nodes[0].url||null,a=t.images.nodes[0].altText||null);const{id:i,price:n}=e;return{...Object.fromEntries(Object.entries(t).filter(([t])=>"variants"!==t)),variantId:i,price:n?.amount||null,imageUrl:r,imageAlt:a}}(t.node))}catch(t){throw console.error("Fetch Products Error:",t),t}}async function n(t){try{if(!t.id)throw new Error("No variant id provided for addToCart");const e=t.quantity||1,r=t.properties||{},i={items:[{id:t.id,quantity:e,properties:r}]},n="/cart/add.js",s=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(i)});if(!s.ok){const t=await s.text();throw console.error("[addToCart] Failed to add to cart:",t),new Error("Failed to add to cart")}const o=await s.json();return(0,a.e)("Added to cart!","success",3e3),o}catch(t){throw console.error("[addToCart] Error:",t),(0,a.e)("Error adding to cart","error",5e3),t}}},410:(t,e,r)=>{r.r(e),r.d(e,{iv_dynamic_products:()=>d});var a=r(129),i=r(344);function n(){const t=new Map;return{getItem:e=>t.get(e)||null,setItem:(e,r)=>{t.set(e,r)},removeItem:e=>{t.delete(e)},keys:()=>Array.from(t.keys())}}function s(t){return"undefined"!=typeof Blob?new Blob([t]).size:encodeURIComponent(t).replace(/%../g,"x").length}const o=function(){const{namespace:t,version:e="1",storage:r="local",prefix:a="iv:cache:",defaultTTL:i=3e5,staleTTL:o,maxEntries:c=200,maxValueBytes:d=25e4,serialize:l=JSON.stringify,deserialize:u=JSON.parse,dispatchEvents:p=!0,target:m=("undefined"!=typeof window?window:void 0)}={namespace:"products",version:"1",storage:"local",defaultTTL:3e5,staleTTL:3e5,dispatchEvents:!0},y=function(t){if("memory"===t)return n();const e=function(t){try{if("undefined"==typeof window)return;const e="local"===t?window.localStorage:window.sessionStorage,r="__iv_cache_test__";return e.setItem(r,"1"),e.removeItem(r),e}catch{return}}("session"===t?"session":"local");return e?{getItem:t=>e.getItem(t),setItem:(t,r)=>e.setItem(t,r),removeItem:t=>e.removeItem(t),keys:()=>{const t=[];for(let r=0;r<e.length;r++){const a=e.key(r);a&&t.push(a)}return t}}:n()}(r),v=new Map;let g=0;function h(e,r,a){if(p&&m&&"function"==typeof m.dispatchEvent)try{const i={action:e,key:r,namespace:t,info:a};m.dispatchEvent(new CustomEvent("iv-cache",{detail:i,bubbles:!0,composed:!0}))}catch(t){}}function f(t){return null===t?"null":"object"!=typeof t?JSON.stringify(t):Array.isArray(t)?"["+t.map(f).join(",")+"]":"{"+Object.keys(t).sort().map(e=>JSON.stringify(e)+":"+f(t[e])).join(",")+"}"}function w(r,i){const n=f(i);return`${a}${t}:${r}:${e}:${function(t){let e=5381,r=t.length;for(;r;)e=33*e^t.charCodeAt(--r);return(e>>>0).toString(36)}(n)}`}function b(r,n,o,p){const m=p?.ttl??i,v={v:e,ts:Date.now(),ttl:m,t:n,data:o,meta:p?.meta};try{const e=l(v);if(d&&s(e)>d)return void h("error",r,{reason:"oversize",bytes:s(e)});y.setItem(r,e),h("set",r,{ttl:m,type:n}),function(){if(!y.keys)return;if(g++,g%20!=0)return;const e=y.keys().filter(e=>e.startsWith(`${a}${t}:`));if(e.length<=c)return;const r=e.map(t=>{try{const e=u(y.getItem(t));return{k:t,ts:e?.ts||0}}catch{return{k:t,ts:0}}}).sort((t,e)=>t.ts-e.ts),i=e.length-c;r.slice(0,i).forEach(t=>{x(t.k),h("evict",t.k)})}()}catch(t){h("error",r,{err:t?.message})}}function S(t){const r=function(t){try{const r=y.getItem(t);if(!r)return{isExpired:!0,isStale:!1,ageMs:0};const a=u(r);if(!a||a.v!==e)return{isExpired:!0,isStale:!1,ageMs:0};const i=Date.now()-a.ts,n=i>a.ttl,s=!(!n||!o)&&i<=a.ttl+o;return{data:a.data,meta:a.meta,isExpired:n,isStale:s,ageMs:i,raw:a}}catch(e){return h("error",t,{err:e?.message}),{isExpired:!0,isStale:!1,ageMs:0}}}(t);return r.data&&!r.isExpired?h("hit",t,{ageMs:r.ageMs}):r.data&&r.isExpired&&r.isStale?h("stale",t,{ageMs:r.ageMs}):h("miss",t),r}async function k(t,e,r,a){const i=S(t);if(i.data&&!i.isExpired)return i.data;if(i.data&&i.isStale&&a?.staleWhileRevalidate)return M(t,e,r,a),i.data;if(v.has(t))return v.get(t);const n=(async()=>{try{const i=await r(),n=a?.transform?a.transform(i):i;return b(t,e,n,{ttl:a?.ttl,meta:a?.meta}),n}finally{v.delete(t)}})();return v.set(t,n),n}function M(t,e,r,a){return k(t,e,r,a)}function x(t){y.removeItem(t),h("purge",t)}function $(e){const r=y.keys();for(const i of r)i.startsWith(`${a}${t}:`)&&("function"==typeof e?e(i):e.test(i))&&x(i)}function E(t){return w("data",t)}function T(t){return w("markup",t)}return{buildKey:w,get:S,set:b,getOrSet:k,refresh:M,purge:x,purgePattern:$,clearNamespace:function(){$(()=>!0)},inflight:v,keyForData:E,getData:function(t){return S(E(t))},setData:function(t,e,r){b(E(t),"data",e,r)},getOrSetData:function(t,e,r){return k(E(t),"data",e,r)},keyForMarkup:T,getMarkup:function(t){return S(T(t))},setMarkup:function(t,e,r){b(T(t),"markup",e,r)},getOrSetMarkup:function(t,e,r){return k(T(t),"markup",e,r)}}}(),c="iv-dynamic-products",d=class{constructor(t){(0,a.r)(this,t)}type="BEST_SELLING";limit=8;componenttitle;titletag="h2";collectionhandle="all";carousel=!1;requestedfields="id,title,handle,images,priceRange";calltoaction=!1;buttontext;addtocarttext;emptystring="No products found";gridlayout;cachettl;stale=!0;products=[];errorMsg;staleData=!1;errors=function(t={}){const{component:e,toast:r,toastDuration:i=3e3,emitEvents:n=!0,target:s=window,classifier:o,dedupeMs:c=4e3,defaultUserMessage:d="Something went wrong. Please try again.",maxConsoleStack:l=6,telemetry:u,_sharedRecent:p}=t,m=p||new Map;return{handle:function(t){const{error:p,scope:y,devMessage:v,meta:g}=t,{userSafe:h,severity:f,userMessage:w}=function(t){let e=t.severity||t.level||"error",r=!!t.userMessage,a=t.userMessage;const i=t.error;"TypeError"===i?.name&&/fetch/i.test(i?.message||"")&&(r=!0,a||="Network issue. Please retry.");const n=i?.status||i?.response?.status;if(n&&(n>=400&&n<500&&(r=!0),n>=500&&(r=!1,e="error")),!a&&r&&(a=d),o){const n=o({error:i,scope:t.scope})||{};void 0!==n.userSafe&&(r=n.userSafe),n.severity&&(e=n.severity),n.userMessage&&(a=n.userMessage)}return r||(a=void 0),{userSafe:r,severity:e,userMessage:a}}(t),b=(p?.stack||"").split("\n").slice(0,l).join("\n"),S={id:crypto?.randomUUID?crypto.randomUUID():Date.now().toString(36)+Math.random().toString(36).slice(2),ts:Date.now(),component:e,scope:y,severity:f,userSafe:h,userMessage:w,devMessage:v??(h?p?.message:void 0),raw:p,meta:g,stack:b};if(u?.enrich)try{Object.assign(S,u.enrich(S))}catch(t){}const k=`${(M=S).component||""}|${M.scope}|${M.devMessage||M.userMessage||M.raw?.message||""}|${M.severity}`;var M;const x=m.get(k);x&&Date.now()-x<c?S.deduped=!0:m.set(k,Date.now());const $={...S,raw:void 0};if("debug"===f?console.debug("[iv-error]",$,p):"info"===f?console.info("[iv-error]",$,p):"warn"===f?console.warn("[iv-error]",$,p):console.error("[iv-error]",$,p),h&&!S.deduped&&w&&function(t,e){const n="warn"===(s=e)?"warning":"debug"===s||"info"===s?"info":"error";var s;try{r?r({message:t,variant:n}):(0,a.e)(t,n,i)}catch(t){}}(w,f),n&&!1!==t.emitEvent&&s&&"function"==typeof s.dispatchEvent)try{s.dispatchEvent(new CustomEvent("iv-error",{detail:S,bubbles:!0,composed:!0}))}catch(t){}if(u&&(!u.sampleRate||Math.random()<u.sampleRate)&&(!u.filter||u.filter(S)))try{Promise.resolve(u.record(S)).catch(()=>{})}catch(t){}return S}}}({component:"iv-dynamic-products"});handlePropChange(){this.loadProducts(!0)}async componentWillLoad(){await this.loadProducts(!1)}buildParams(){return{handle:this.collectionhandle||"all",sort:this.type,fields:this.requestedfields,limit:this.limit,currency:a.d.currencyCode}}async loadProducts(t){const e=this.buildParams(),r=this.cachettl||3e5;a.d.loading=!t;try{const t=await o.getOrSetData(e,async()=>await(0,i.f)(this.limit,this.collectionhandle,this.type,this.requestedfields),{ttl:r,staleWhileRevalidate:this.stale,transform:t=>t}),a=o.getData(e);this.staleData=a.isExpired&&a.isStale,this.products=t||[]}catch(t){this.errorMsg="Failed to load products",this.errors.handle({error:t,scope:"loadProducts",userMessage:"Unable to load products right now.",devMessage:"fetchProducts failed in iv-dynamic-products",severity:"error"})}finally{a.d.loading=!1}}render(){const t=this.titletag;return(0,a.h)("div",{key:"dadb80b347e47ca3c37313199cb4e8dca341cf59",class:c,"data-stale":this.staleData?"true":"false"},this.componenttitle&&(0,a.h)(t,{key:"cbab8c8a8252b0cf44d42632c1f26c4ad9a12406",class:`${c}-title`},this.componenttitle),a.d.loading?(0,a.h)("iv-spinner",null):this.errorMsg?(0,a.h)("div",{class:`${c}-error`},this.errorMsg):0===this.products.length?(0,a.h)("div",{class:`${c}-empty`},this.emptystring):(0,a.h)("div",{class:`${c}-products`},(0,a.h)("iv-layout",{classModifier:`${c}-layout`,gridTemplateAreas:this.gridlayout},this.products.map(t=>(0,a.h)("iv-card",{cardtype:"products",calltoaction:this.calltoaction,buttontext:this.buttontext,addtocarttext:this.addtocarttext,data:t,classmodifier:`${c}-card`}))),this.staleData&&(0,a.h)("div",{class:`${c}-stale-indicator`,"aria-live":"polite"},"Refreshing…")))}static get watchers(){return{type:["handlePropChange"],limit:["handlePropChange"],collectionhandle:["handlePropChange"],requestedfields:["handlePropChange"]}}};d.style=".iv-dynamic-products{box-sizing:border-box;width:var(--iv-dynamic-products-width, 100%);max-width:var(--iv-dynamic-products-max-width, 100%);margin:var(--iv-dynamic-products-margin, 0);padding:var(--iv-dynamic-products-padding, 0);background:var(--iv-dynamic-products-bg, transparent);border:var(--iv-dynamic-products-border, none);border-radius:var(--iv-dynamic-products-radius, 0);box-shadow:var(--iv-dynamic-products-shadow, none);color:var(--iv-dynamic-products-color, inherit);--iv-layout-gap:var(--iv-dynamic-products-gap, 1.5rem)}.iv-dynamic-products-title{margin:var(--iv-dynamic-products-title-margin, 0 0 1rem 0);font-size:var(--iv-dynamic-products-title-font-size, clamp(1.125rem, 1vw + 1rem, 1.75rem));font-weight:var(--iv-dynamic-products-title-font-weight, 600);line-height:var(--iv-dynamic-products-title-line-height, 1.2);letter-spacing:var(--iv-dynamic-products-title-letter-spacing, normal)}.iv-dynamic-products-error,.iv-dynamic-products-empty{padding:var(--iv-dynamic-products-state-padding, 1rem);border:var(--iv-dynamic-products-state-border, none);background:var(--iv-dynamic-products-state-bg, transparent);color:var(--iv-dynamic-products-state-color, inherit);font-size:var(--iv-dynamic-products-state-font-size, 0.875rem);text-align:var(--iv-dynamic-products-state-text-align, center)}.iv-dynamic-products-products{width:100%;margin:var(--iv-dynamic-products-products-margin, 0);padding:var(--iv-dynamic-products-products-padding, 0)}.iv-layout--iv-dynamic-products-layout{--iv-layout-gap:var(--iv-dynamic-products-grid-gap, var(--iv-dynamic-products-gap, 1.5rem));align-items:var(--iv-dynamic-products-grid-align, stretch);justify-content:var(--iv-dynamic-products-grid-justify, flex-start)}.iv-dynamic-products .iv-card{margin:var(--iv-dynamic-products-card-margin, 0);--iv-card-padding:var(--iv-dynamic-products-card-padding, var(--iv-card-padding, 0))}@media (min-width: 40rem){.iv-dynamic-products{--iv-dynamic-products-gap:var(--iv-dynamic-products-gap-md, var(--iv-dynamic-products-gap, 1.5rem))}}@media (min-width: 64rem){.iv-dynamic-products{--iv-dynamic-products-gap:var(--iv-dynamic-products-gap-lg, var(--iv-dynamic-products-gap, 1.5rem))}}.iv-dynamic-products--scroll-x .iv-layout--iv-dynamic-products-layout{display:flex !important;overflow-x:auto;scrollbar-width:var(--iv-dynamic-products-scrollbar-width, thin);-webkit-overflow-scrolling:touch}.iv-dynamic-products--scroll-x .iv-layout--iv-dynamic-products-layout>*{flex:0 0 var(--iv-dynamic-products-scroll-item-width, 75%)}@media (prefers-reduced-motion: reduce){.iv-dynamic-products{scroll-behavior:auto}}"}}]);